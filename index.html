<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flutter Add-to-App: Integrating into Native Apps</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            scroll-behavior: smooth;
        }
        .slide {
            min-height: 90vh; /* Slightly increased min-height */
            padding: 5rem 2rem; /* Increased padding */
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            border-bottom: 1px solid #e5e7eb; /* Light border between slides */
        }
        .slide:last-child {
            border-bottom: none;
        }
        .slide-title {
            font-size: 2.5rem; /* Slightly larger title */
            font-weight: 700;
            margin-bottom: 1.75rem; /* Adjusted margin */
            color: #111827; 
        }
        .slide-subtitle {
            font-size: 1.375rem; /* Slightly larger subtitle */
            font-weight: 500;
            margin-bottom: 2.5rem; /* Adjusted margin */
            color: #374151; 
            max-width: 800px; /* Limit subtitle width */
        }
        .content-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); /* Slightly larger minmax */
            gap: 2.5rem; /* Increased gap */
            width: 100%;
            max-width: 1100px; /* Increased max width */
        }
        .content-card {
            background-color: white;
            padding: 2rem; /* Increased padding */
            border-radius: 0.75rem; 
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); /* Softer shadow */
            text-align: left;
            display: flex;
            flex-direction: column;
        }
        .content-card h3 {
            font-size: 1.25rem; /* Larger card title */
            font-weight: 600;
            margin-bottom: 1rem; 
            color: #1f2937;
            display: flex;
            align-items: center;
        }
        .content-card h3 svg {
            margin-right: 0.75rem; /* Space for icon */
        }
        .content-card p, .content-card ul {
            font-size: 1rem; /* Larger base text */
            color: #4b5563;
            line-height: 1.7; /* Increased line height */
        }
        .content-card ul {
            list-style-position: outside; /* Better alignment */
            padding-left: 1.25rem; /* Indent for bullets */
            margin-top: 0.5rem;
        }
        .content-card li {
            margin-bottom: 0.5rem; /* More space between list items */
        }
        .code-snippet {
            background-color: #2d3748; /* Darker blue-gray */
            color: #e2e8f0; /* Lighter text */
            padding: 1.25rem;
            border-radius: 0.5rem; 
            font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, Courier, monospace;
            font-size: 0.9rem; 
            overflow-x: auto;
            text-align: left;
            margin-top: 1rem;
            border: 1px solid #4a5568; /* Subtle border */
        }
        .nav-bar {
            position: sticky;
            top: 0;
            background-color: rgba(255, 255, 255, 0.85); /* Slightly more transparent */
            backdrop-filter: blur(12px); /* Increased blur */
            padding: 1rem 2rem;
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1), 0 2px 4px -1px rgba(0,0,0,0.06);
            z-index: 50;
            display: flex;
            justify-content: center;
            flex-wrap: wrap; /* Allow wrapping on smaller screens */
            gap: 0.5rem 1rem; /* Adjust gap for wrapping */
        }
        .nav-link {
            color: #374151;
            font-weight: 500;
            padding: 0.6rem 1.2rem; /* Slightly more padding */
            border-radius: 0.375rem; 
            transition: background-color 0.2s ease-in-out, color 0.2s ease-in-out, transform 0.1s ease;
        }
        .nav-link:hover {
            background-color: #e5e7eb; 
            color: #111827;
            transform: translateY(-1px); /* Subtle hover effect */
        }
        .diagram-placeholder {
            width: 100%;
            max-width: 700px; /* Increased max-width */
            min-height: 350px; /* Increased min-height */
            background-color: #f9fafb; /* Very light gray */
            border: 2px dashed #d1d5db; 
            display: flex;
            flex-direction: column; /* Allow multiple lines */
            justify-content: center;
            align-items: center;
            border-radius: 0.75rem; /* More rounded */
            margin: 2rem auto; /* Increased margin */
            color: #6b7280; 
            padding: 1.5rem;
            font-size: 0.9rem;
            line-height: 1.5;
        }
        .button-primary {
            background-color: #2563eb; 
            color: white;
            padding: 0.85rem 1.75rem; /* More padding */
            border-radius: 0.5rem;
            font-weight: 600; /* Bolder */
            transition: background-color 0.2s ease-in-out, transform 0.1s ease;
            display: inline-block;
            margin-top: 2rem; /* Increased margin */
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1);
        }
        .button-primary:hover {
            background-color: #1d4ed8; 
            transform: translateY(-2px); /* More pronounced hover */
        }

        /* Mobile responsiveness adjustments */
        @media (max-width: 768px) {
            .slide {
                padding: 3rem 1rem; 
            }
            .slide-title {
                font-size: 1.875rem; 
            }
            .slide-subtitle {
                font-size: 1.125rem; 
            }
            .content-grid {
                grid-template-columns: 1fr; /* Single column on mobile */
            }
            .nav-bar {
                justify-content: space-around;
            }
            .nav-link {
                 padding: 0.5rem 0.8rem;
                 font-size: 0.9rem;
            }
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

    <nav class="nav-bar">
        <a href="#slide1" class="nav-link">Intro</a>
        <a href="#slide2" class="nav-link">Why Add-to-App?</a>
        <a href="#slide3" class="nav-link">Core "How"</a>
        <a href="#slide4" class="nav-link">Architecture</a>
        <a href="#slide5" class="nav-link">POC / Demo</a>
        <a href="#slide6" class="nav-link">Next Steps</a>
    </nav>

    <section id="slide1" class="slide bg-gradient-to-br from-blue-600 to-indigo-700 text-white">
        <h1 class="text-4xl md:text-5xl lg:text-6xl font-bold mb-6">Flutter Add-to-App</h1>
        <p class="text-xl md:text-2xl lg:text-3xl font-light mb-10">Integrating Flutter Incrementally into Native iOS & Android</p>
        <p class="text-lg md:text-xl">Technical Deep Dive for Experienced Teams</p>
    </section>

    <section id="slide2" class="slide">
        <h2 class="slide-title">The Strategic "Why" (Briefly)</h2>
        <p class="slide-subtitle">While you know Flutter's strengths, add-to-app offers specific strategic advantages for existing native codebases.</p>
        <div class="content-grid">
            <div class="content-card">
                <h3><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-7 h-7 text-blue-500"><path fill-rule="evenodd" d="M15.312 5.312a.75.75 0 010 1.06L8.837 12.85c-.14.141-.33.22-.53.22s-.39-.079-.53-.22L4.688 9.756a.75.75 0 011.06-1.06l2.5 2.5 5.994-5.994a.75.75 0 011.06 0z" clip-rule="evenodd" /></svg>Leverage Existing Investment</h3>
                <p>Preserve stable native features and business logic while introducing Flutter for new UIs or feature modules.</p>
            </div>
            <div class="content-card">
                <h3><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-7 h-7 text-green-500"><path d="M10.75 16.82A7.5 7.5 0 103.18 9.25a.75.75 0 000 1.5A6 6 0 1110.75 4.82v2.43a.75.75 0 001.5 0V3.5a.75.75 0 00-.75-.75h-3.75a.75.75 0 000 1.5h2.43z" /><path d="M8.25 8.25a.75.75 0 000 1.5h3.5a.75.75 0 000-1.5h-3.5z" /></svg>Targeted Modernization</h3>
                <p>Incrementally replace specific native screens or flows with Flutter, focusing on areas needing UI/UX uplift or faster iteration.</p>
            </div>
            <div class="content-card">
                <h3><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-7 h-7 text-purple-500"><path fill-rule="evenodd" d="M12.25 3.197a.75.75 0 01.75.75v1.5a.75.75 0 01-1.5 0v-1.5a.75.75 0 01.75-.75zm2.506.67a.75.75 0 01.922-.396l1.062.53a.75.75 0 01-.395.923l-1.061-.531a.75.75 0 01-.528-.526zm-4.633-.396a.75.75 0 01.923.396l-.531 1.062a.75.75 0 01-.923-.396l.53-1.061zm-.396 4.632a.75.75 0 01.526.528l-.53 1.06a.75.75 0 01-.924-.395l.531-1.061a.75.75 0 01.392-.132zM4.133 6.397a.75.75 0 01.396.923l-.53 1.062a.75.75 0 01-.924-.396l.531-1.061a.75.75 0 01.527-.528zM10 6.5A3.5 3.5 0 0113.5 10H16a6 6 0 10-5.293 5.803.75.75 0 01.027-.024V10A3.5 3.5 0 0110 6.5zM11.5 10a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0z" clip-rule="evenodd" /></svg>Unified Dev Experience (for new parts)</h3>
                <p>Utilize Flutter's developer experience for new modules, potentially improving team velocity for those specific parts.</p>
            </div>
             <div class="content-card">
                <h3><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-7 h-7 text-yellow-500"><path fill-rule="evenodd" d="M10 1a4.5 4.5 0 00-4.5 4.5V9H5a2 2 0 00-2 2v6a2 2 0 002 2h10a2 2 0 002-2v-6a2 2 0 00-2-2h-.5V5.5A4.5 4.5 0 0010 1zm3 8V5.5a3 3 0 10-6 0V9h6z" clip-rule="evenodd" /></svg>Skillset Expansion</h3>
                <p>Allows native teams to gradually adopt Flutter, expanding their skillset and future-proofing development capabilities.</p>
            </div>
        </div>
    </section>

    <section id="slide3" class="slide bg-gray-200"> <h2 class="slide-title">The Core "How": Technical Pillars</h2>
        <p class="slide-subtitle">Understanding the key mechanisms for integrating Flutter modules.</p>
        <div class="content-grid">
            <div class="content-card">
                <h3>Flutter Module & Build Artifacts</h3>
                <p>A Flutter project of type `module` (`flutter create -t module`) produces specific build artifacts for native integration:</p>
                <ul>
                    <li><strong>iOS:</strong> `.xcframework` (includes `Flutter.xcframework`, `App.xcframework`, and plugin frameworks).</li>
                    <li><strong>Android:</strong> `.aar` (Android Archive).</li>
                </ul>
                <p class="mt-2">These are then linked against/included in the native host application.</p>
            </div>
            <div class="content-card">
                <h3>FlutterEngine: The Heartbeat</h3>
                <p>The `FlutterEngine` instance is critical. It hosts your Dart VM, isolates, and runs your Flutter application code.</p>
                <ul>
                    <li>Manages the entire lifecycle of a Flutter instance.</li>
                    <li>**Performance:** Pre-warming and caching an engine via `FlutterEngineCache` is vital for fast "warm starts" of Flutter views.</li>
                    <li>`FlutterEngineGroup` can be used for multiple, resource-sharing Flutter instances if needed.</li>
                </ul>
            </div>
            <div class="content-card">
                <h3>Platform Channels: The Bridge</h3>
                <p>Enable bi-directional communication between Dart and native (Swift/Kotlin/Java/Obj-C) code.</p>
                <ul>
                    <li><strong>`MethodChannel`</strong>: For invoking methods and receiving results (most common).</li>
                    <li><strong>`EventChannel`</strong>: For streaming data from native to Dart.</li>
                    <li><strong>`BasicMessageChannel`</strong>: For simpler, potentially codec-optimized messaging.</li>
                    <li><strong>Pigeon:</strong> A code-generation tool for type-safe platform channels, reducing boilerplate. Recommended for complex interactions.</li>
                </ul>
            </div>
            <div class="content-card">
                <h3>Native Embedding APIs</h3>
                <p>Platform-specific classes provided by Flutter to host and display the Flutter UI within the native app hierarchy.</p>
                <ul>
                    <li><strong>iOS (Swift/Obj-C):</strong> `FlutterViewController` is presented or pushed like any native `UIViewController`.</li>
                    <li><strong>Android (Kotlin/Java):</strong>
                        <ul>
                            <li>`FlutterActivity`: For full-screen Flutter experiences.</li>
                            <li>`FlutterFragment`: To embed Flutter as part of a native layout.</li>
                            <li>`FlutterView`: Direct view access (less common for add-to-app).</li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </section>

    <section id="slide4" class="slide">
        <h2 class="slide-title">Architectural Overview</h2>
        <p class="slide-subtitle">Visualizing the interaction between the native host and the Flutter module.</p>
        <div class="diagram-placeholder">
            <p class="font-semibold mb-2">Native Host Application (iOS/Android)</p>
            <div class="grid grid-cols-2 gap-4 w-full max-w-md mb-2">
                <div class="border border-gray-400 p-2 rounded">Native UI (Activities/ViewControllers)</div>
                <div class="border border-gray-400 p-2 rounded">Native Business Logic / SDKs</div>
            </div>
            <p class="my-1 text-blue-600 font-bold">&uarr;&darr; Manages & Displays &uarr;&darr;</p>
            <div class="border-2 border-blue-500 p-3 rounded-lg bg-blue-50 w-full max-w-lg">
                <p class="font-semibold text-blue-700">Flutter Embedding Layer</p>
                <p class="text-sm text-blue-600">(`FlutterViewController`, `FlutterActivity`/`Fragment`)</p>
                <p class="my-1 text-green-600 font-bold">&harr; Hosts &harr;</p>
                <div class="border border-green-500 p-2 rounded bg-green-50">
                    <p class="font-semibold text-green-700">FlutterEngine</p>
                    <p class="text-xs text-green-600">(Cached or new, potentially via FlutterEngineGroup)</p>
                </div>
            </div>
            <p class="my-1 text-purple-600 font-bold">&uarr;&darr; Communication Bridge &uarr;&darr;</p>
            <div class="border-2 border-purple-500 p-3 rounded-lg bg-purple-50 w-full max-w-lg">
                <p class="font-semibold text-purple-700">Platform Channels / Pigeon</p>
                <p class="text-sm text-purple-600">(`MethodChannel`, `EventChannel`, Generated Code)</p>
            </div>
             <p class="my-1 text-teal-600 font-bold">&harr; Executes &harr;</p>
            <div class="border-2 border-teal-500 p-3 rounded-lg bg-teal-50 w-full max-w-lg">
                <p class="font-semibold text-teal-700">Flutter Module (Dart Code)</p>
                <p class="text-sm text-teal-600">UI (Widgets), Business Logic, State Management</p>
            </div>
        </div>
        <div class="max-w-3xl mx-auto text-left mt-6 space-y-3 text-gray-700 text-base">
            <p>The native application instantiates and manages one or more `FlutterEngine` instances. These engines execute Dart code from the Flutter module.</p>
            <p>Native embedding APIs (`FlutterViewController`, `FlutterActivity`, etc.) are used to render the Flutter UI within the native view hierarchy. These can be launched to display full-screen Flutter experiences or integrated as partial screen elements (especially on Android with `FlutterFragment`).</p>
            <p>Platform Channels (or Pigeon for type safety) facilitate all communication, enabling data passing, invoking methods, and event streaming between the native and Flutter layers.</p>
        </div>
    </section>

    <section id="slide5" class="slide bg-gray-200">
        <h2 class="slide-title">Illustrative POC & Demo Strategy</h2>
        <p class="slide-subtitle">A phased approach to demonstrate capability and explore value.</p>
        <div class="content-grid">
            <div class="content-card">
                <h3>POC: Foundational Integration</h3>
                <p>Objective: Confirm successful setup, build, and basic interop.</p>
                <ul>
                    <li>Integrate a simple Flutter module into minimal native iOS & Android hosts.</li>
                    <li>Demonstrate launching a Flutter screen from native.</li>
                    <li>Implement basic back-navigation (e.g., `SystemNavigator.pop()` or simple platform channel).</li>
                    <li>Focus on `FlutterEngine` initialization (ideally pre-warmed).</li>
                    <li>Key Output: Working example, documented setup steps.</li>
                </ul>
            </div>
            <div class="content-card">
                <h3>Demo: Value-Driven Scenario</h3>
                <p>Objective: Showcase a practical use case with more complex interactions.</p>
                <p class="font-semibold mt-2">Example: "Native List -> Flutter Detail Screen"</p>
                <ul>
                    <li>Native screen displays a list of items.</li>
                    <li>Tapping an item launches a Flutter screen, passing item ID/data.</li>
                    <li>Flutter screen displays rich details (potentially fetching more data).</li>
                    <li>Action in Flutter (e.g., "Save") communicates back to update native state/UI via Platform Channel/Pigeon.</li>
                    <li>Focus: Data passing, navigation with context, bi-directional updates, Flutter UI capabilities.</li>
                </ul>
            </div>
        </div>
        <a href="https://github.com/your-repo/your-poc-project" target="_blank" rel="noopener noreferrer" class="button-primary">View Example POC/Demo on GitHub</a>
        <p class="mt-4 text-sm text-gray-600">(Replace with your actual repository link when available)</p>
    </section>

    <section id="slide6" class="slide">
        <h2 class="slide-title">Path Forward & Advanced Considerations</h2>
        <div class="max-w-4xl mx-auto space-y-8">
            <div class="content-card text-left">
                <h3>Core Implementation Steps</h3>
                <ol class="list-decimal list-inside space-y-1">
                    <li>Define clear integration points and features for initial Flutter modules.</li>
                    <li>Establish Flutter module structure and native project configurations.</li>
                    <li>Implement `FlutterEngine` management strategy (e.g., caching).</li>
                    <li>Develop Platform Channel / Pigeon contracts for communication.</li>
                    <li>Thoroughly test navigation, data passing, and lifecycle management across boundaries.</li>
                </ol>
            </div>
            <div class="grid md:grid-cols-2 gap-6">
                <div class="content-card text-left">
                    <h3>Key Technical Considerations</h3>
                    <ul>
                        <li><strong class="text-blue-600">Engine Lifecycle:</strong> Align FlutterEngine with native component lifecycles.</li>
                        <li><strong class="text-blue-600">State Synchronization:</strong> Strategies for keeping native and Flutter states consistent if needed.</li>
                        <li><strong class="text-blue-600">Plugin Conflicts:</strong> Managing potential conflicts if both native and Flutter use similar underlying SDKs.</li>
                        <li><strong class="text-blue-600">Build & CI/CD:</strong> Integrating Flutter module builds into the main native app pipeline.</li>
                    </ul>
                </div>
                <div class="content-card text-left">
                    <h3>Advanced Exploration (Future Steps)</h3>
                    <p>For deeper integration or leveraging existing complex native logic:</p>
                    <ul>
                        <li><strong>Pigeon:</strong> Strongly consider for robust, type-safe platform channels from the start.</li>
                        <li><strong>FFIGEN (Dart FFI):</strong> To call existing C/C++ libraries directly from Dart. Useful for reusing native performance-critical code or SDKs.</li>
                        <li><strong>JNIGEN (via FFI or Pigeon):</strong> To interface with existing Java/Kotlin code more directly than standard method channels, potentially for complex object marshalling or performance-sensitive paths on Android (often involves custom JNI code or tools that generate JNI bindings).</li>
                        <li><strong>Shared Business Logic in Native:</strong> Explore migrating parts of existing native business logic to be callable from Dart (via FFI/JNI) to avoid rewriting and ensure consistency.</li>
                    </ul>
                </div>
            </div>
            <div class="mt-10">
                <h3 class="text-2xl font-semibold mb-3">Open Discussion</h3>
                <p class="text-gray-700 text-lg">Identifying opportunities and addressing technical questions for our specific context.</p>
            </div>
        </div>
    </section>

    <footer class="text-center p-8 bg-gray-800 text-gray-400 text-sm">
        Flutter Add-to-App Technical Overview &copy; <span id="year"></span>. [Your Company/Team Name Here]
    </footer>

    <script>
        document.getElementById('year').textContent = new Date().getFullYear();
        
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const targetId = this.getAttribute('href');
                const targetElement = document.querySelector(targetId);
                if (targetElement) {
                    // Calculate offset if nav-bar is sticky
                    const navBarHeight = document.querySelector('.nav-bar')?.offsetHeight || 0;
                    const elementPosition = targetElement.getBoundingClientRect().top;
                    const offsetPosition = elementPosition + window.pageYOffset - navBarHeight;
        
                    window.scrollTo({
                        top: offsetPosition,
                        behavior: 'smooth'
                    });
                }
            });
        });
    </script>

</body>
</html>
